<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Ydream&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Ydream&#39;s Blog">
<meta property="og:url" content="https://ydreamw.github.io/index.html">
<meta property="og:site_name" content="Ydream&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Ydream">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Ydream's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Ydream&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">个人向博客，记录一下个人的碎碎念和一些成长</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://YdreamW.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-《深入浅出nodejs》阅读笔记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/19/%E3%80%8A%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAnodejs%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2021-08-19T14:14:28.000Z" itemprop="datePublished">2021-08-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/19/%E3%80%8A%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAnodejs%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/">《深入浅出nodejs》阅读笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>闲来无事，想仔细了解一下nodejs，在知乎上查了一下node的读物，很多人推荐这一本朴灵的书。于是开个坑，读一读</p>
<p>我的阅读笔记一向如此：摘抄为主，个人感悟为辅。主要是便于自己复习回顾。(单押有没有！)</p>
<h2 id="1、Node简介"><a href="#1、Node简介" class="headerlink" title="1、Node简介"></a>1、Node简介</h2><p>这一章主要讲了Node的起源和其特点，包括应用场景</p>
<h3 id="1-1-Node的起源"><a href="#1-1-Node的起源" class="headerlink" title="1.1 Node的起源"></a>1.1 Node的起源</h3><p>Node的作者 Ryan Dahl 是一个C/C++的程序员，C语言偏底层，偏硬件。而我们的作者先生的工作主要是围绕高性能的web服务器来进行的。他总结出了高性能的Web服务器的特点为： 事件驱动和非阻塞I/O。</p>
<blockquote>
<p>高性能、符号事件驱动、没有历史包袱</p>
</blockquote>
<p>在选择语言的时候，JavaScript脱颖而出: C语言门槛太高（懂得都懂）；Lua有很多阻塞IO库，构建非阻塞IO库阻力大；Ruby虚拟机性能差。</p>
<p>而JavaScript的开发门槛低，历史包袱少，后端没有市场。并且JavaScript在前端有广泛的事件驱动方面的应用。</p>
<h3 id="1-2-Node的特点"><a href="#1-2-Node的特点" class="headerlink" title="1.2 Node的特点"></a>1.2 Node的特点</h3><ul>
<li>异步I/O<blockquote>
<p>在Node中，绝大多数的操作都以异步的方式进行调用</p>
</blockquote>
</li>
<li>事件与回调函数</li>
<li>单线程<blockquote>
<p>在Node中,JavaScript与其余线程是无法共享任何状态的。单线程的最大好是不用像多线程编程那样处处在意状态同步的问题,这里没有死锁的存在,也没有线程上下文交换所带来的性能上的开销。</p>
</blockquote>
</li>
</ul>
<p>单线程的缺点则是无法利用多核CPU、错误会引起整个应用退出，大量计算占用CPU导致无法继续调用异步I/O</p>
<ul>
<li>跨平台</li>
</ul>
<h3 id="1-3-Node的应用场景"><a href="#1-3-Node的应用场景" class="headerlink" title="1.3 Node的应用场景"></a>1.3 Node的应用场景</h3><ul>
<li>I/O 密集型</li>
<li>CPU密集型，通过合理的调度可以胜任</li>
<li>分布式应用</li>
</ul>
<h2 id="2、-模块机制"><a href="#2、-模块机制" class="headerlink" title="2、 模块机制"></a>2、 模块机制</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://ydreamw.github.io/2021/08/19/%E3%80%8A%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAnodejs%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" data-id="ckslne9ro0000r4vl7t9lh2wf" data-title="《深入浅出nodejs》阅读笔记" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-你不知道的JS上阅读笔记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/17/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JS%E4%B8%8A%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2021-08-17T04:51:35.000Z" itemprop="datePublished">2021-08-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/17/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JS%E4%B8%8A%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/">你不知道的JS上阅读笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>最近在准备秋招，知乎上无意间看到了这本书，扫了眼内容以后觉得这本书写的很好，因此抽空读一遍。</p>
<p>这个系列的读书笔记主要是我对书中学到的知识进行的摘抄。偶尔会有一些个人想法，</p>
<h2 id="1、作用域是什么"><a href="#1、作用域是什么" class="headerlink" title="1、作用域是什么"></a>1、作用域是什么</h2><p>对于 <code>var a = 2</code> 的理解</p>
<p>编译器将 <code>var a </code>当作一句声明，会查看作用域内是否有a，有的话忽略，没有的话在作用域内新增变量a</p>
<p>引擎将 <code>a = 2 </code>当作一句运行语句，去查找 a </p>
<p>(这里也让我明白了为什么 js会有变量的声明提升，因为他的编译和运行是分开来的两个过程)</p>
<h3 id="LHS-和-RHS"><a href="#LHS-和-RHS" class="headerlink" title="LHS 和 RHS"></a>LHS 和 RHS</h3><p>LHS:Left-Hand-Side</p>
<p>RHS：Right-Hand-Side</p>
<p>即赋值的左侧和右侧：当出现在赋值操作的左侧时进行LHS查询，出现在右侧时进行RHS查询。</p>
<p>LHS找引用（地址），RHS获取值即可。前者递归寻找失败会在全局作用域声明该变量（严格模式下会报ReferenceError），后者递归寻找失败也会报ReferenceError，如果对该变量进行不合理操作报TypeError</p>
<blockquote>
<p>ReferenceError 同作用域判别失败相关，而TypeError 则代表作用域判别成功了，但是对<br> 结果的操作是非法或不合理的。</p>
</blockquote>
<h2 id="2、词法作用域"><a href="#2、词法作用域" class="headerlink" title="2、词法作用域"></a>2、词法作用域</h2><h3 id="词法阶段"><a href="#词法阶段" class="headerlink" title="词法阶段"></a>词法阶段</h3><blockquote>
<p>全局变量会自动成为全局对象（比如浏览器中的window 对象）的属性，因此<br>可以不直接通过全局对象的词法名称，而是间接地通过对全局对象属性的引<br>用来对其进行访问。<br><code>window.a</code><br>通过这种技术可以访问那些被同名变量所遮蔽的全局变量。但非全局的变量<br>如果被遮蔽了，无论如何都无法被访问到。</p>
</blockquote>
<blockquote>
<p>无论函数在哪里被调用，也无论它如何被调用，它的词法作用域都只由函数被声明时所处<br>的位置决定。</p>
</blockquote>
<h3 id="欺骗词法"><a href="#欺骗词法" class="headerlink" title="欺骗词法"></a>欺骗词法</h3><p>这一节讲了改变词法作用域的一些方式，主要是 eval 和 with</p>
<blockquote>
<p>JavaScript 中有两种机制来实现这个目的。社区普遍认为在代码中使用这两种机制并不是<br> 什么好注意。但是关于它们的争论通常会忽略掉最重要的点：<strong>欺骗词法作用域会导致性能<br> 下降。</strong></p>
</blockquote>
<p>之前早就在知乎上看到人说 eval 和 with 会严重影响性能。现在了解到了 WHY</p>
<p>另外 with 这个语法 我以前是从来没有了解过的。</p>
<h4 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h4><blockquote>
<p>默认情况下，如果eval(..) 中所执行的代码包含有一个或多个声明（无论是变量还是函<br> 数），就会对eval(..) 所处的词法作用域进行修改。</p>
</blockquote>
<blockquote>
<p>在严格模式的程序中，eval(..) 在运行时有其自己的词法作用域，意味着其<br> 中的声明无法修改所在的作用域。</p>
</blockquote>
<h4 id="with"><a href="#with" class="headerlink" title="with"></a>with</h4><p>作者举了两个例子，并且对它们进行详解，进而解释了with的用法及缺点</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">c</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 单调乏味的重复&quot;obj&quot;</span></span><br><span class="line">obj.a = <span class="number">2</span>;</span><br><span class="line">obj.b = <span class="number">3</span>;</span><br><span class="line">obj.c = <span class="number">4</span>;</span><br><span class="line"><span class="comment">// 简单的快捷方式</span></span><br><span class="line"><span class="keyword">with</span> (obj) &#123;</span><br><span class="line">    a = <span class="number">3</span>;</span><br><span class="line">    b = <span class="number">4</span>;</span><br><span class="line">    c = <span class="number">5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的例子就是with的大多数用法，这也是大多数入门教程上讲解（没错，看到这里我突然想起来我在菜鸟教程上看到过这个玩意，只不过忘了）</p>
<p>接下来作者举了另外一个例子，这个例子讲揭示 with 的真正作用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">with</span> (obj) &#123;</span><br><span class="line">      a = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o1 = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> o2 = &#123;</span><br><span class="line">    <span class="attr">b</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line">foo( o1 );</span><br><span class="line"><span class="built_in">console</span>.log( o1.a ); <span class="comment">// 2</span></span><br><span class="line">foo( o2 );</span><br><span class="line"><span class="built_in">console</span>.log( o2.a ); <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.log( a ); <span class="comment">// 2——不好，a 被泄漏到全局作用域上了！</span></span><br></pre></td></tr></table></figure>
<p>重点关注o2的部分</p>
<blockquote>
<p>with 可以将一个没有或有多个属性的对象处理为一个完全隔离的词法作用域，因此这个对<br> 象的属性也会被处理为定义在这个作用域中的词法标识符。</p>
</blockquote>
<blockquote>
<p>尽管with 块可以将一个对象处理为词法作用域，但是这个块内部正常的var<br> 声明并不会被限制在这个块的作用域中，而是被添加到with 所处的函数作<br> 用域中。</p>
</blockquote>
<blockquote>
<p>eval(..) 函数如果接受了含有一个或多个声明的代码，就会修改其所处的词法作用域，而<br> with 声明实际上是根据你传递给它的对象凭空创建了一个全新的词法作用域。</p>
</blockquote>
<blockquote>
<p>进行正常的 LHS 标识符查找</p>
</blockquote>
<p>o2 的作用域、foo(..) 的作用域和全局作用域中都没有找到标识符a，因此当a＝2 执行<br> 时，自动创建了一个全局变量（因为是非严格模式）。</p>
<p>这个例子的讲解非常明确</p>
<h4 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h4><blockquote>
<p>JavaScript 引擎会在编译阶段进行数项的性能优化。其中有些优化依赖于能够根据代码的<br> 词法进行静态分析，并预先确定所有变量和函数的定义位置，才能在执行过程中快速找到<br> 标识符。</p>
</blockquote>
<blockquote>
<p>最悲观的情况是如果出现了eval(..) 或with，所有的优化可能都是无意义的，因此最简<br> 单的做法就是完全不做任何优化。</p>
</blockquote>
<h2 id="3、函数作用域与块作用域"><a href="#3、函数作用域与块作用域" class="headerlink" title="3、函数作用域与块作用域"></a>3、函数作用域与块作用域</h2><h3 id="函数作用域"><a href="#函数作用域" class="headerlink" title="函数作用域"></a>函数作用域</h3><p>es5 中函数会创建一个新的作用域，这个作用域包括函数的参数、函数内部声明的各个变量。并且值得注意的是嵌套在函数内部定义的函数，是可以访问其外层的作用域的。</p>
<p>声明在一个函数内部的变量或函数会在所处的作用域中“隐藏”起来。</p>
<h3 id="块作用域"><a href="#块作用域" class="headerlink" title="块作用域"></a>块作用域</h3><p>es6 中let和const声明的变量支持块作用域</p>
<p>es5中 with是块作用域的一个例子</p>
<p>另一个不常被人注意的例子是 try/catch</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="literal">undefined</span>(); <span class="comment">// 执行一个非法操作来强制制造一个异常</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (err) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log( err ); <span class="comment">// 能够正常执行！</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log( err ); <span class="comment">// ReferenceError: err not found</span></span><br></pre></td></tr></table></figure>
<p>catch语句中是一个块作用域。 （这也是es6语法转化为es5的一个解决方案）</p>
<h2 id="4、提升"><a href="#4、提升" class="headerlink" title="4、提升"></a>4、提升</h2><p>变量的声明提升其实按照先前提过的 编译器和引擎 两步走的方式是很容易理解的，这里可以重申一次：</p>
<p>我们的编译器先对代码进行一次执行，它会把所有的变量声明都进行处理。在此之后，引擎再从头开始执行代码，这样我们就会感受到后面声明的变量被提升。</p>
<p>而且变量的声明可以覆盖。</p>
<p>另一个原则是： <strong>函数的声明会被优先提升</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">foo(); <span class="comment">// 3</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="number">1</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="number">2</span> );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="number">3</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>foo进行了两次函数声明，一次变量声明，这里被提升为了函数，输出了3。而如果第三个函数没有声明的话，输出的结果应当是1，尽管在第一次函数声明之后又再一次对foo进行了变量声明。</p>
<p>一个普通块内部的函数声明通常会被提升到所在作用域的顶部，这个过程不会像下面的代码暗示的那样可以被条件判断所控制：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">foo(); <span class="comment">// &quot;b&quot;</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (a) &#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;a&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;b&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很明显，因为我们的编译器不会执行代码，它没有办法判断a到底是true还是false</p>
<h2 id="5、作用域闭包"><a href="#5、作用域闭包" class="headerlink" title="5、作用域闭包"></a>5、作用域闭包</h2><p>下面这一章的内容十分重要。它让我重新审视闭包，也刷新了我之前对于闭包的粗浅的认识。正如作者说的，闭包它其实并没有特别神秘，相反，它时常出现在我们写下的代码之中。只要我们对于作用域的理解足够深刻，那么闭包的概念就显得十分自然。事实上闭包是作用域下的必然产物。</p>
<blockquote>
<p>当函数可以记住并访问所在的词法作用域时，就产生了闭包，即使函数是在当前词法作用域之外执行。</p>
</blockquote>
<p>这句话也可以这样理解，函数与其所在的词法作用域共同构成了闭包。（这个词法作用域会被函数记住，并且可以访问）。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ydreamw.github.io/2021/08/17/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JS%E4%B8%8A%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" data-id="cksg739na0000s0vl266mbyty" data-title="你不知道的JS上阅读笔记" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/15/hello-world/" class="article-date">
  <time class="dt-published" datetime="2021-08-15T10:34:58.560Z" itemprop="datePublished">2021-08-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/15/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ydreamw.github.io/2021/08/15/hello-world/" data-id="cksd3yxm20000x8vlaedf0m1c" data-title="Hello World" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-hexo" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/14/hello-hexo/" class="article-date">
  <time class="dt-published" datetime="2021-07-14T11:36:15.000Z" itemprop="datePublished">2021-07-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/07/14/hello-hexo/">hello hexo</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="搭建Hexo"><a href="#搭建Hexo" class="headerlink" title="搭建Hexo"></a>搭建Hexo</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://ydreamw.github.io/2021/07/14/hello-hexo/" data-id="cksd4v27x0000oovl8cgx51iv" data-title="hello hexo" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Linux-Lab3" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/06/21/Linux-Lab3/" class="article-date">
  <time class="dt-published" datetime="2020-06-20T17:03:12.000Z" itemprop="datePublished">2020-06-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/20ss/">20ss</a>►<a class="article-category-link" href="/categories/20ss/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/06/21/Linux-Lab3/">Linux-Lab3</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="shell程序设计"><a href="#shell程序设计" class="headerlink" title="shell程序设计"></a>shell程序设计</h1><p><code>课程名称：  Linux应用技术基础</code></p>
<p><code>实验类型：综合型</code></p>
<p><code>实验项目名称： shell程序设计</code></p>
<h2 id="一、实验环境"><a href="#一、实验环境" class="headerlink" title="一、实验环境"></a>一、实验环境</h2><p>操作系统：Windows 10 家庭中文版 64位操作系统，基于x64的处理器</p>
<p>处理器： Intel(R) Core(TM)i7-8750H CPU 2.20GHz 2.21 GHz</p>
<p>内存(RAM ) ： 16.0GB</p>
<p>Linux版本： Ubuntu-1904</p>
<h2 id="二、实验内容和结果及分析"><a href="#二、实验内容和结果及分析" class="headerlink" title="二、实验内容和结果及分析"></a>二、实验内容和结果及分析</h2><h4 id="1、编写一个shell脚本程序，它带一个命令行参数，这个参数是一个文件名。如果这个文件是一个普通文件，则打印文件所有者的名字和最后的修改日期。如果程序带有多个参数，则输出出错信息。"><a href="#1、编写一个shell脚本程序，它带一个命令行参数，这个参数是一个文件名。如果这个文件是一个普通文件，则打印文件所有者的名字和最后的修改日期。如果程序带有多个参数，则输出出错信息。" class="headerlink" title="1、编写一个shell脚本程序，它带一个命令行参数，这个参数是一个文件名。如果这个文件是一个普通文件，则打印文件所有者的名字和最后的修改日期。如果程序带有多个参数，则输出出错信息。"></a>1、编写一个shell脚本程序，它带一个命令行参数，这个参数是一个文件名。如果这个文件是一个普通文件，则打印文件所有者的名字和最后的修改日期。如果程序带有多个参数，则输出出错信息。</h4><p>code</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [ $2 ];then  #more than one parameter</span><br><span class="line">    echo &quot;Too many parmeters, please input exactly one parameter!&quot;</span><br><span class="line">elif [ $1 ];then</span><br><span class="line">    if test -f &quot;$1&quot;;then #get input</span><br><span class="line">        ownername=$(ls -l $1 | awk &#x27;&#123;print $3&#125;&#x27;) #get name</span><br><span class="line">        month=$(ls -l $1 | awk &#x27;&#123;print $6&#125;&#x27;) #get month</span><br><span class="line">        day=$(ls -l $1 | awk &#x27;&#123;print $7&#125;&#x27;) #get day</span><br><span class="line">        time=$(ls -l $1 | awk &#x27;&#123;print $8&#125;&#x27;) #get time</span><br><span class="line">        #output</span><br><span class="line">        echo &quot;Filename:$1&quot;</span><br><span class="line">        echo &quot;Owner&#x27;s name:$ownername&quot;</span><br><span class="line">        echo &quot;Modify time:$month $day $time&quot;</span><br><span class="line">    else 	#not a file</span><br><span class="line">        echo &quot;$1 is not a ordinary file&quot;</span><br><span class="line">    fi</span><br><span class="line">else</span><br><span class="line">    echo &quot;You should input one parameter!&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>test:</p>
<p>创建test文件和dir文件夹</p>
<p><img src="/2020/06/21/Linux-Lab3/image-20200617210417017.png" alt="image-20200617210417017"></p>
<p>以依次通过没有参数、一个文件参数、一个目录参数、两个参数来测试sh</p>
<p><img src="/2020/06/21/Linux-Lab3/image-20200617211223892.png" alt="image-20200617211223892"></p>
<p>如图  获得了预期的结果。</p>
<h4 id="2、-编写shell程序，统计指定目录下的普通文件、子目录及可执行文件的数目，统计该目录下所有普通文件字节数总和，目录的路径名字由参数传入。"><a href="#2、-编写shell程序，统计指定目录下的普通文件、子目录及可执行文件的数目，统计该目录下所有普通文件字节数总和，目录的路径名字由参数传入。" class="headerlink" title="2、 编写shell程序，统计指定目录下的普通文件、子目录及可执行文件的数目，统计该目录下所有普通文件字节数总和，目录的路径名字由参数传入。"></a>2、 编写shell程序，统计指定目录下的普通文件、子目录及可执行文件的数目，统计该目录下所有普通文件字节数总和，目录的路径名字由参数传入。</h4><p>code</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh</span></span><br><span class="line">echo &quot;normal files:&quot; `find $1 -type f | wc -l` #normal files</span><br><span class="line">echo &quot;subdirectory:&quot;`find $1 -type d | wc -l` #subdirectory</span><br><span class="line">echo &quot;executable files:&quot; `find $1 -type f -executable | wc -l` #executable files</span><br><span class="line">num=0 </span><br><span class="line">for file_name in `ls $1` #for each file</span><br><span class="line">do</span><br><span class="line">    file=$1&quot;/&quot;$file_name #get the path</span><br><span class="line">    if [ -f $file ] #if it is an ordinary file</span><br><span class="line">	    then</span><br><span class="line">		    ch=$(cat $file | wc -c) #get the number of  chars</span><br><span class="line">		    num=$(($num+$ch)) </span><br><span class="line">    fi</span><br><span class="line">done</span><br><span class="line">echo &quot;total char num: $num&quot;</span><br></pre></td></tr></table></figure>



<p><img src="/2020/06/21/Linux-Lab3/image-20200617213350746.png" alt="image-20200617213350746"></p>
<p>在lab3中实验，可以看到结果正确。</p>
<h4 id="3、编写一个shell-脚本，输入一个字符串，忽略（删除）非字母后，检测该字符串是否为回文-palindrome-。对于一个字符串，如果从前向后读和从后向前读都是同一个字符串，则称之为回文串。例如，单词“mom”，“dad”和“noon”都是回文串。"><a href="#3、编写一个shell-脚本，输入一个字符串，忽略（删除）非字母后，检测该字符串是否为回文-palindrome-。对于一个字符串，如果从前向后读和从后向前读都是同一个字符串，则称之为回文串。例如，单词“mom”，“dad”和“noon”都是回文串。" class="headerlink" title="3、编写一个shell 脚本，输入一个字符串，忽略（删除）非字母后，检测该字符串是否为回文(palindrome)。对于一个字符串，如果从前向后读和从后向前读都是同一个字符串，则称之为回文串。例如，单词“mom”，“dad”和“noon”都是回文串。"></a>3、编写一个shell 脚本，输入一个字符串，忽略（删除）非字母后，检测该字符串是否为回文(palindrome)。对于一个字符串，如果从前向后读和从后向前读都是同一个字符串，则称之为回文串。例如，单词“mom”，“dad”和“noon”都是回文串。</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh</span></span><br><span class="line">echo -n &quot;Please input the string:&quot;</span><br><span class="line">read line     ##get input</span><br><span class="line">str=`echo $line | tr -c -d [:alpha:] `   ##delete other chars</span><br><span class="line">reverse=`echo $str | rev`</span><br><span class="line">if [ $str = $reverse ];     ##check if int the same</span><br><span class="line">then</span><br><span class="line">    echo &quot;$str is palindorme.&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;$str isn&#x27;t palindorme&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>



<p><img src="/2020/06/21/Linux-Lab3/image-20200617214722800.png" alt="image-20200617214722800"></p>
<p>尝试了几组测试结果，成功忽略了非字母，并且判断回文结果正确。</p>
<h4 id="4、编写一个shell脚本，把当前目录下文件大小大于100K的文件全部移动到-tmp-目录下。"><a href="#4、编写一个shell脚本，把当前目录下文件大小大于100K的文件全部移动到-tmp-目录下。" class="headerlink" title="4、编写一个shell脚本，把当前目录下文件大小大于100K的文件全部移动到~/tmp/ 目录下。"></a>4、编写一个shell脚本，把当前目录下文件大小大于100K的文件全部移动到~/tmp/ 目录下。</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh</span></span><br><span class="line">find ./ -type f -size +100k -exec mv &#123;&#125; ~/tmp/ \;  ##find语句来实现</span><br></pre></td></tr></table></figure>



<p><img src="/2020/06/21/Linux-Lab3/image-20200617215559497.png" alt="image-20200617215559497"></p>
<p>创建好tmp后，我们执行shell后发现两个大于100k的文件被移动到了/home/ydream/tmp下</p>
<p>####5、编写一个实现文件备份和同步的shell脚本程序dirsync。程序的参数是两个需要备份同步的目录，如:</p>
<p>$dirsync <del>/dir1 ~/dir2$  # $</del>/dir1$为源目录，$~/dir2$为目标目录​</p>
<p><strong>dirsync程序实现两个目录内的所有文件和子目录（递归所有的子目录）内容保持一致。程序基本功能如下。</strong></p>
<p><strong>1)     备份功能：目标目录将使用来自源目录的最新文件，新文件和新子目录进行升级，源目录将保持不变。dirsync程序能够实现增量备份。</strong></p>
<p><strong>2)     同步功能：两个方向上的旧文件都将被最新文件替换，新文件都将被双向复制。源目录被删除的文件和子目录，目标目录也要对应删除。</strong></p>
<p><strong>代码1</strong></p>
<p>代码1通过比较文件更改时间来进行，子目录使用递归进行更新备份</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> dirsync.sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Two modes:</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 1. back-up</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. synchronize</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Judge the input parameter</span></span><br><span class="line">if [ $# -ne 2 ] #judge the number of parameter</span><br><span class="line">then</span><br><span class="line">        echo &quot;program: $0 needs one prameter.&quot;</span><br><span class="line">        exit 1</span><br><span class="line">fi</span><br><span class="line">if [[ ! -d $1 || ! -d $2 ]] #check if they are dictionary</span><br><span class="line">then</span><br><span class="line">	echo &quot;parameters must be dirctory&quot;</span><br><span class="line">	exit 1</span><br><span class="line">fi</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The definitions of <span class="built_in">functions</span> used</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> To update file.</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> @parameters : <span class="built_in">source</span> file, destination path and <span class="built_in">source</span> path</span></span><br><span class="line"></span><br><span class="line">function update_file &#123;</span><br><span class="line">    new_file=$2\/$1</span><br><span class="line">    source_file=$3\/$1   </span><br><span class="line">    if [`! -f $new_file`] &amp;&amp; [ `stat -c %Y $new_file` -gt `stat -c %Y $source_file` ] </span><br><span class="line">    then </span><br><span class="line">        cp -fp $source_file $new_file </span><br><span class="line">        echo &quot;File &quot;$source_file&quot; has been copied&quot;</span><br><span class="line">        cnt_update=$cnt_update+1    # cnt the number</span><br><span class="line">        return 1</span><br><span class="line">    fi</span><br><span class="line">    return 0</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> To delete the file that doesn<span class="string">&#x27;t exist in the given source file.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> @Parameters : source file, destination path and source path</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> Use a dictionary /tmp to replace rm</span></span></span><br><span class="line">function delete_file &#123;</span><br><span class="line">    if test -f $2\/$1</span><br><span class="line">    then</span><br><span class="line">        :</span><br><span class="line">    else</span><br><span class="line">        mv $3\/$1 \/tmp </span><br><span class="line">        echo &quot;File &quot;$3\/$1&quot; has been deleted&quot;</span><br><span class="line">        cnt_delete=$cnt_delete+1 # cnt the number</span><br><span class="line">        return 1</span><br><span class="line">    fi</span><br><span class="line">    return 0</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> To update a directory.</span></span> </span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> @Parameters : source dir, destination path and source path</span></span></span><br><span class="line"></span><br><span class="line">function update_dir &#123;</span><br><span class="line">    cnt=0</span><br><span class="line">    if test -d $2\/$1    </span><br><span class="line">    then</span><br><span class="line">        for item in $(ls $3\/$1)</span><br><span class="line">        do</span><br><span class="line">            if test -d $3\/$1\/$item</span><br><span class="line">            then</span><br><span class="line">                update_dir $item $2\/$item $3\/$1 # recursively update</span><br><span class="line">            elif test -f $3\/$1\/$item</span><br><span class="line">            then </span><br><span class="line">                update_file $item $2\/$1 $3\/$1 # check the file</span><br><span class="line">                if (( $? == 1 )) </span><br><span class="line">                then </span><br><span class="line">                    cnt=$cnt+1</span><br><span class="line">                fi</span><br><span class="line">            fi</span><br><span class="line">        done</span><br><span class="line">    else </span><br><span class="line">        cp -fpr $3\/$1 $2\/$1</span><br><span class="line">        echo &quot;Directory &quot;$3\/$1&quot; has been copied&quot;</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> To delete the directory that doesn&#x27;</span>t exist <span class="keyword">in</span> the given <span class="built_in">source</span> file.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> @Parameters : <span class="built_in">source</span> dir(<span class="variable">$1</span>), destination path(<span class="variable">$2</span>) and <span class="built_in">source</span> path(<span class="variable">$3</span>)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Use a dictionary /tmp to replace rm</span></span><br><span class="line">function delete_dir &#123;</span><br><span class="line">    cnt=0</span><br><span class="line">    if test -d $2\/$1  </span><br><span class="line">    then</span><br><span class="line">        for item in $(ls $3\/$1) </span><br><span class="line">        do</span><br><span class="line">            if test -d $3\/$1\/$item # check if it is a dir</span><br><span class="line">            then</span><br><span class="line">                delete_dir $item $2\/$item $3\/$1 # recursively delete</span><br><span class="line">                continue</span><br><span class="line">            fi</span><br><span class="line">            if test -f $3\/$1\/$item # check if it is a file</span><br><span class="line">            then </span><br><span class="line">                delete_file $item $2\/$1 $3\/$1 # delete a file</span><br><span class="line">                if (( $? == 1 ))</span><br><span class="line">                then </span><br><span class="line">                    cnt=$cnt+1</span><br><span class="line">                fi</span><br><span class="line">                continue</span><br><span class="line">            fi</span><br><span class="line">        done</span><br><span class="line">    else</span><br><span class="line">        mv $3\/$1 \/tmp # safely remove</span><br><span class="line">        echo &quot;Directory &quot;$3\/$1&quot; has been deleted&quot;</span><br><span class="line">    fi </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Main</span></span><br><span class="line"></span><br><span class="line">source_dir=$&#123;1:-./&#125;       </span><br><span class="line">destination_dir=$&#123;2:-./&#125;  </span><br><span class="line">declare -i cnt_update=0 # counter of update</span><br><span class="line">declare -i cnt_delete=0 # counter of deletion</span><br><span class="line">echo &quot;---------------------------------Welcome To Dirsync---------------------------------&quot;</span><br><span class="line">echo -e &quot;Source directory       : \033[33m $&#123;source_dir&#125; \033[0m&quot;</span><br><span class="line">echo -e &quot;Destination directory  : \033[33m $&#123;destination_dir&#125; \033[0m&quot;</span><br><span class="line">echo &quot;mode1 Backup : $&#123;destination_dir&#125; will be updated with the file from $&#123;source_dir&#125;&quot; </span><br><span class="line">echo &quot;mode2 Synchronize: all the old files will be updated.&quot;</span><br><span class="line">read -p &quot;Please input mode and press Enter (1/2) : &quot; mode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if [ $mode = 1 ]</span><br><span class="line">then</span><br><span class="line">    # back-up </span><br><span class="line">    echo -e &quot;\033[31mbackup... \033[0m&quot;</span><br><span class="line">    # Note that the &#x27;/&#x27; is removed</span><br><span class="line">    source_dir=$&#123;source_dir%/&#125;</span><br><span class="line">    destination_dir=$&#123;destination_dir%/&#125;</span><br><span class="line">    for item in $(ls $&#123;source_dir&#125;\/)</span><br><span class="line">    do</span><br><span class="line">        tmp_path=$source_dir\/$item</span><br><span class="line">        if test -d $tmp_path</span><br><span class="line">        then</span><br><span class="line">            update_dir $item $destination_dir $source_dir</span><br><span class="line">        elif test -f $tmp_path</span><br><span class="line">        then</span><br><span class="line">            update_file $item $destination_dir $source_dir</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line"></span><br><span class="line">    echo -e &quot;\033[32mBackup done! \033[0m&quot;</span><br><span class="line">    echo &quot;Totally updated $&#123;cnt_update&#125; files.&quot;</span><br><span class="line">elif [ $mode = 2 ]</span><br><span class="line">then</span><br><span class="line">    # Synchronize</span><br><span class="line"></span><br><span class="line">    echo -e &quot;\033[31mSynchronize... \033[0m&quot;</span><br><span class="line">    source_dir=$&#123;source_dir%/&#125;</span><br><span class="line">    destination_dir=$&#123;destination_dir%/&#125;</span><br><span class="line">    </span><br><span class="line">    tmp=$source_dir</span><br><span class="line">    source_dir=$destination_dir</span><br><span class="line">    destination_dir=$tmp</span><br><span class="line">    </span><br><span class="line">    for item in $(ls $&#123;source_dir&#125;\/)</span><br><span class="line">    do</span><br><span class="line">        tmp_path=$source_dir\/$item</span><br><span class="line">        if test -d $tmp_path</span><br><span class="line">        then</span><br><span class="line">            delete_dir $item $destination_dir $source_dir</span><br><span class="line">        elif test -f $tmp_path</span><br><span class="line">        then</span><br><span class="line">            delete_file $item $destination_dir $source_dir</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">    </span><br><span class="line">    for item in $(ls $&#123;source_dir&#125;\/)</span><br><span class="line">    do</span><br><span class="line">        tmp_path=$source_dir\/$item</span><br><span class="line">        if test -d $tmp_path</span><br><span class="line">        then</span><br><span class="line">            update_dir $item $destination_dir $source_dir</span><br><span class="line">        elif test -f $tmp_path</span><br><span class="line">        then</span><br><span class="line">            update_file $item $destination_dir $source_dir</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">    </span><br><span class="line">    tmp=$source_dir</span><br><span class="line">    source_dir=$destination_dir</span><br><span class="line">    destination_dir=$tmp</span><br><span class="line"></span><br><span class="line">    for item in $(ls $&#123;source_dir&#125;\/)</span><br><span class="line">    do</span><br><span class="line">        tmp_path=$source_dir\/$item</span><br><span class="line">        if test -d $tmp_path</span><br><span class="line">        then</span><br><span class="line">            update_dir $item $destination_dir $source_dir</span><br><span class="line">        elif test -f $tmp_path</span><br><span class="line">        then</span><br><span class="line">            update_file $item $destination_dir $source_dir</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">    # echo some relavant information</span><br><span class="line">    echo -e &quot;\033[32mSynchronize done!\033[0m&quot;</span><br><span class="line">    echo &quot;Totally updated $&#123;cnt_update&#125; files.&quot;</span><br><span class="line">    echo &quot;Totally deleted $&#123;cnt_delete&#125; files.&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;Invalid input!&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>1）备份功能</p>
<p>  <img src="/2020/06/21/Linux-Lab3/image-20200621224325527.png" alt="image-20200621224325527"></p>
<p>  <img src="/2020/06/21/Linux-Lab3/image-20200621230030247.png" alt="image-20200621230030247"></p>
<p>  如图1</p>
<p>  dir为源目录，newDir为新目录</p>
<p>  dir中包含1 2 3 三个文件，newDir中没有文件</p>
<p>  执行shell，选择模式1（备份模式），可以看到更新了1 2 3三个文件出现在了newDir中</p>
<p>  然后我们在dir目录下更改文件3，并且新建文件4</p>
<p>  再次执行shell，选择模式1（备份模式）， 根据log，我们发现只有3  4被更新了，查看发现1 2 3 4 均出现在newDir中</p>
<p>  图2展示了子目录的情况。</p>
</li>
<li><p>2）同步功能</p>
<p>  <img src="/2020/06/21/Linux-Lab3/image-20200621225539926.png" alt="image-20200621225539926"></p>
<p>  首先对新目录进行备份，使用模式1</p>
<p>  接着删除dir/1  更改dir/2 更改newDir/3  新建dir/4</p>
<p>  运行shell，使用模式2</p>
<p>  根据log，可以看到，</p>
<p>  newDir1 被删除，说明源目录中文件被删除，目标目录下文件也被删除</p>
<p>  newDir3 被复制到dir3 中  dir2被复制到newDir2中，说明双向可以同步文件</p>
<p>  dir中新建的文件4  被复制到newDir中，说明双向可以更新文件</p>
</li>
</ul>
<p><strong>代码2</strong></p>
<p>代码2使用了rsync命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">!#/bin/bash</span><br><span class="line">mkdir tmp   ##使用临时文件夹</span><br><span class="line">rsync -av $2 tmp   ##使用rsync来同步</span><br><span class="line">for item in `ls tmp/$2`   ##遍历移动</span><br><span class="line">do </span><br><span class="line">    mv -f tmp/$2/$item tmp</span><br><span class="line">done</span><br><span class="line">rm -rf tmp/$2</span><br><span class="line">rm -f $2    ##删除</span><br><span class="line"></span><br><span class="line">rsync -av $1 $2   ##以下内容同上，通过一个临时文件夹来实现同步</span><br><span class="line"></span><br><span class="line">for item in `ls $2/$1`</span><br><span class="line">do</span><br><span class="line">    mv -f $2/$1/$item $2</span><br><span class="line">done</span><br><span class="line">rm -rf $2/$1</span><br><span class="line">rsync -av tmp $1</span><br><span class="line"></span><br><span class="line">for item in `ls $1/tmp`</span><br><span class="line">do</span><br><span class="line">    mv -f $1/tmp/$item $1</span><br><span class="line">done</span><br><span class="line">rm -rf $1/tmp</span><br><span class="line">rm -rf tmp</span><br></pre></td></tr></table></figure>



<p>展示</p>
<p><img src="/2020/06/21/Linux-Lab3/image-20200621230926295.png" alt="image-20200621230926295"></p>
<p><img src="/2020/06/21/Linux-Lab3/image-20200621230937698.png" alt="image-20200621230937698"></p>
<p>过程同代码1，不赘述</p>
<p>##三、感想和讨论</p>
<p>这个实验中，从简单到复杂，一共写了5个shell脚本，让我对于shell编程有了更深的理解，从简单的几个命令拼凑，到分支结构，到循环结构。在最后一个题目中更是使用了递归函数。在编程的过程中，我拿shell编程和c语言编程做类比，在逻辑上并没有遇到很大的困难，不过shell的语法十分严格，并且没有较好的编辑器来及时检查错误，或者代码补全，以致于经常写完以后没有办法运行。对于我的细心有很大的磨砺。</p>
<p>遇到的问题：</p>
<p>1）在windows环境下编写shell以后通过ftp保存到linux，运行会报错<code>/bin/bash^M: bad interpreter: No such file or directory</code></p>
<p>查询后发现，原因在于windows下shell是dos格式，linux是unix格式，换行符存在差异。解决方案是用vim打开shell，输入<code>set ff=unix</code> 命令就可以解决</p>
<p>2）在linux直接运行shell会报错 <code>Permission denied</code> 这是因为sh没有权限访问 <code>/bin/bash </code></p>
<p>只需要通过chmod为shell增加权限即可</p>
<p>3）在实验五中，理解题意花了挺长的时间。由于之前接触过rsync用来同步windows和远程linux服务器的文件，因此首先想到了直接使用rsync命令来完成实验。但是又觉得老师出题的目的应该是想要我们自己去写一个shell来完成这些功能。想了很久，并且与同学讨论之后，想到了使用时间来判断先后，通过直接复制文件来进行同步。当然，最后实现的功能是远远不及直接使用rsync的。并且我写的shell，只能粗暴的根据时间来进行复制，如果文件都有更新，则没办法正确的同步。最好还是使用git等源代码管理工具或者rsync等来进行多端同步。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ydreamw.github.io/2020/06/21/Linux-Lab3/" data-id="cksngrqio00022kvlb6qdcpj4" data-title="Linux-Lab3" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Linux-Lab2" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/05/31/Linux-Lab2/" class="article-date">
  <time class="dt-published" datetime="2020-05-30T17:03:09.000Z" itemprop="datePublished">2020-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/20ss/">20ss</a>►<a class="article-category-link" href="/categories/20ss/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/05/31/Linux-Lab2/">Linux-Lab2</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Linux的第二次Lab，进行shell命令的实践<br>见GitHub连接：  <a target="_blank" rel="noopener" href="https://github.com/YdreamW/20ss/blob/master/Linux/shell%E5%91%BD%E4%BB%A4.pdf">https://github.com/YdreamW/20ss/blob/master/Linux/shell%E5%91%BD%E4%BB%A4.pdf</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ydreamw.github.io/2020/05/31/Linux-Lab2/" data-id="cksngrqil00012kvl5ad5h39a" data-title="Linux-Lab2" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-DBS-Project4-数据库编程" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/05/03/DBS-Project4-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/" class="article-date">
  <time class="dt-published" datetime="2020-05-02T17:43:51.000Z" itemprop="datePublished">2020-05-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/20ss/">20ss</a>►<a class="article-category-link" href="/categories/20ss/DBS/">DBS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/05/03/DBS-Project4-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/">DBS-Project4-数据库编程</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>###实验目的</p>
<ul>
<li> 掌握MySQL数据库函数和存储过程的定义、调用方法</li>
<li>巩固MySQL数据库触发器定义和使用方法</li>
<li>熟悉JDBC连接访问数据库的方法</li>
<li>了解MySQL备份和恢复方法</li>
</ul>
<h3 id="实验平台"><a href="#实验平台" class="headerlink" title="实验平台"></a>实验平台</h3><ul>
<li><p>数据库管理系统（MySQL）</p>
</li>
<li><p>pymysql</p>
</li>
</ul>
<h3 id="实验内容和要求"><a href="#实验内容和要求" class="headerlink" title="实验内容和要求"></a>实验内容和要求</h3><h4 id="1、建立数据库，并录入数据"><a href="#1、建立数据库，并录入数据" class="headerlink" title="1、建立数据库，并录入数据"></a>1、建立数据库，并录入数据</h4><p>该部分内容延用之前的代码，不赘述。</p>
<h4 id="2、函数、存储过程的创建和调用："><a href="#2、函数、存储过程的创建和调用：" class="headerlink" title="2、函数、存储过程的创建和调用："></a>2、函数、存储过程的创建和调用：</h4><ul>
<li><p>使用函数实现统计学生选修课程数量的功能。</p>
<ul>
<li><p>代码</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$</span><br><span class="line">CREATE FUNCTION my_count(NAME VARCHAR(20)) RETURNS INT</span><br><span class="line">DETERMINISTIC</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE str VARCHAR(5);</span><br><span class="line">	DECLARE a INT;</span><br><span class="line">	SELECT SID FROM S WHERE SNAME=NAME INTO str;</span><br><span class="line">	SELECT COUNT(CID) FROM SC WHERE SID = str INTO a;</span><br><span class="line">	RETURN a;</span><br><span class="line">END</span><br><span class="line">$$</span><br><span class="line">delimiter;</span><br><span class="line">SELECT my_count(&quot;Wang feng&quot;);</span><br></pre></td></tr></table></figure></li>
<li><p>结果</p>
<p>  <img src="/2020/05/03/DBS-Project4-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/image-20200503225509049.png" alt="image-20200503225509049"></p>
</li>
</ul>
</li>
<li><p>使用存储过程实现查询某个学生选修的课程的总学分。</p>
<ul>
<li><p>代码</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$</span><br><span class="line">CREATE PROCEDURE my_count(IN NAME VARCHAR(20), OUT my_sum INT)</span><br><span class="line">DETERMINISTIC</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE str VARCHAR(5);</span><br><span class="line">	SELECT SID FROM S WHERE SNAME=NAME INTO str;</span><br><span class="line">	SELECT sum(credit) FROM C WHERE CID in (SELECT CID FROM SC WHERE SID = str) INTO my_sum;</span><br><span class="line">END</span><br><span class="line">$$</span><br><span class="line">delimiter;</span><br><span class="line">CALL my_count(&quot;Wang feng&quot;,@credits);</span><br><span class="line">SELECT (@credits);</span><br></pre></td></tr></table></figure>

</li>
<li><p>结果</p>
</li>
</ul>
</li>
</ul>
<p><img src="/2020/05/03/DBS-Project4-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/image-20200503230601198.png" alt="image-20200503230601198"></p>
<p>####3、触发器的创建</p>
<ul>
<li><p>删除一个学生信息，确保SC中也不存在该学生的信息；</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SET foreign_key_checks = 0;</span><br><span class="line">delimiter $$</span><br><span class="line">CREATE TRIGGER s_delete AFTER DELETE ON s FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">	DELETE FROM SC WHERE SID not in (SELECT SID FROM S);</span><br><span class="line">END</span><br><span class="line">$$</span><br><span class="line">delimiter;</span><br></pre></td></tr></table></figure>

</li>
<li><p>添加选课信息时，确保课程存在。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$</span><br><span class="line">CREATE TRIGGER course_insert_check before insert</span><br><span class="line">ON sc FOR EACH ROW</span><br><span class="line">begin</span><br><span class="line">	 declare msg varchar(100);</span><br><span class="line">     if NEW.CID not in (select CID from C)</span><br><span class="line">     THEN</span><br><span class="line">         SET msg = CONCAT(&#x27;illegal messege&#x27;);</span><br><span class="line">		SIGNAL SQLSTATE &#x27;HY000&#x27; SET MESSAGE_TEXT = msg;</span><br><span class="line">     end if;</span><br><span class="line">end</span><br><span class="line">$$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h4 id="4、使用python实现数据库连接访问"><a href="#4、使用python实现数据库连接访问" class="headerlink" title="4、使用python实现数据库连接访问"></a>4、使用python实现数据库连接访问</h4><ul>
<li><p>代码</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql </span><br><span class="line"></span><br><span class="line"><span class="comment"># select all avaliable courses</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_courses</span>(<span class="params">cursor</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;show all courses&#x27;</span>)</span><br><span class="line">    cursor.execute(<span class="string">&#x27;select distinct CNAME from C&#x27;</span>)</span><br><span class="line">    output = cursor.fetchall()</span><br><span class="line">    <span class="built_in">print</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="comment"># check a course</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_course</span>(<span class="params">cursor,sid</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;select physics course for&#x27;</span> +sid)</span><br><span class="line">    sql = <span class="string">&quot;select * from C where CID not in(select CID from SC where SID = %s);&quot;</span></span><br><span class="line">    cursor.execute(sql,sid)</span><br><span class="line">    output = cursor.fetchall()</span><br><span class="line">    <span class="built_in">print</span>(output)</span><br><span class="line">    conn.commit()</span><br><span class="line"></span><br><span class="line"><span class="comment">#select a course</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">select_course</span>(<span class="params">cursor,sid,cid</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;select %s course for %s&#x27;</span>%(cid,sid))</span><br><span class="line">    cursor.execute(<span class="string">&#x27;insert into SC (SID, CID, GRADE) values(%s, %s, %s)&#x27;</span>, [<span class="string">&#x27;S3&#x27;</span>, <span class="string">&#x27;C2&#x27;</span>, <span class="number">0</span>])</span><br><span class="line">    output = cursor.fetchall()</span><br><span class="line">    <span class="built_in">print</span>(output)</span><br><span class="line">    conn.commit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># select all courses that have been selected</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_selected_courses</span>(<span class="params">cursor</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;show all courses that have been selected&#x27;</span>)</span><br><span class="line">    cursor.execute(<span class="string">&#x27;select distinct CNAME from SC natural join C&#x27;</span>)</span><br><span class="line">    output = cursor.fetchall()</span><br><span class="line">    <span class="built_in">print</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="comment"># select all courses that have been selected by someone</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_selected_courses_by_someone</span>(<span class="params">cursor,sid</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;show all courses that have been selected by %s&#x27;</span>%(sid))</span><br><span class="line">    cursor.execute(<span class="string">&#x27;select distinct CNAME from SC natural join C where SID = %s&#x27;</span>, sid)</span><br><span class="line">    output = cursor.fetchall()</span><br><span class="line">    <span class="built_in">print</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="comment"># drop out of a course</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quit_course</span>(<span class="params">cursor,sid,cid</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;drop out of the %s course for %s&#x27;</span>%(cid,sid))</span><br><span class="line">    sql = <span class="string">&quot;delete from SC where SID =%s and CID = %s;&quot;</span></span><br><span class="line">    cursor.execute(sql,(sid,cid))</span><br><span class="line">    output = cursor.fetchall()</span><br><span class="line">    <span class="built_in">print</span>(output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># connect database</span></span><br><span class="line">conn = pymysql.connect(host = <span class="string">&#x27;127.0.0.1&#x27;</span>, port = <span class="number">3306</span>, user = <span class="string">&#x27;root&#x27;</span>, passwd = <span class="string">&#x27;123&#x27;</span>, db = <span class="string">&#x27;school&#x27;</span>)</span><br><span class="line">cursor = conn.cursor()</span><br><span class="line"></span><br><span class="line">show_courses(cursor)</span><br><span class="line">select_course(cursor,<span class="string">&#x27;S2&#x27;</span>,<span class="string">&#x27;C2&#x27;</span>)</span><br><span class="line">show_selected_courses(cursor)</span><br><span class="line">quit_course(cursor,<span class="string">&#x27;S2&#x27;</span>,<span class="string">&#x27;C2&#x27;</span>)</span><br><span class="line">show_selected_courses_by_someone(cursor,<span class="string">&#x27;S1&#x27;</span>)</span><br></pre></td></tr></table></figure>

</li>
<li><p>结果</p>
<p>  <img src="/2020/05/03/DBS-Project4-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/image-20200503235014718.png" alt="image-20200503235014718"></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ydreamw.github.io/2020/05/03/DBS-Project4-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/" data-id="cksni4d9v0005rgvl7izo8eeh" data-title="DBS-Project4-数据库编程" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/database/" rel="tag">database</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Linux-Lab1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/04/30/Linux-Lab1/" class="article-date">
  <time class="dt-published" datetime="2020-04-29T17:03:06.000Z" itemprop="datePublished">2020-04-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/20ss/">20ss</a>►<a class="article-category-link" href="/categories/20ss/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/04/30/Linux-Lab1/">Linux-Lab1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Linux 课程的第一次lab。要求自选课题进行调研。</p>
<p>见Github连接: <a target="_blank" rel="noopener" href="https://github.com/YdreamW/20ss/blob/master/Linux/lab1-%E7%A0%94%E7%A9%B6%E6%8A%A5%E5%91%8A.pdf">https://github.com/YdreamW/20ss/blob/master/Linux/lab1-%E7%A0%94%E7%A9%B6%E6%8A%A5%E5%91%8A.pdf</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ydreamw.github.io/2020/04/30/Linux-Lab1/" data-id="cksngrqfq00002kvl5tpx513h" data-title="Linux-Lab1" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-DBS-Project3-SQL数据完整性" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/" class="article-date">
  <time class="dt-published" datetime="2020-04-01T17:43:21.000Z" itemprop="datePublished">2020-04-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/20ss/">20ss</a>►<a class="article-category-link" href="/categories/20ss/DBS/">DBS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/">DBS-Project3-SQL数据完整性</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="实验3-SQL数据完整性"><a href="#实验3-SQL数据完整性" class="headerlink" title="实验3-SQL数据完整性"></a>实验3-SQL数据完整性</h1><p>###实验目的</p>
<ul>
<li>掌握MySQL数据库的完整性约束的定义方法；</li>
<li>掌握MySQL数据库的用户的创建方法。</li>
<li>掌握MySQL数据库的权限设置方法。</li>
</ul>
<h3 id="实验平台"><a href="#实验平台" class="headerlink" title="实验平台"></a>实验平台</h3><p>数据库管理系统（MySQL）</p>
<h3 id="实验内容和要求"><a href="#实验内容和要求" class="headerlink" title="实验内容和要求"></a>实验内容和要求</h3><h5 id="1、建立数据库school"><a href="#1、建立数据库school" class="headerlink" title="1、建立数据库school"></a>1、建立数据库school</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE school;</span><br></pre></td></tr></table></figure>

<h5 id="2、数据的定义"><a href="#2、数据的定义" class="headerlink" title="2、数据的定义"></a>2、数据的定义</h5><p>利用create创建三张表,同时增加主键外键约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE S (</span><br><span class="line">	SID VARCHAR ( 20 ) ,</span><br><span class="line">	SNAME VARCHAR ( 20 ),</span><br><span class="line">	AGE INT,</span><br><span class="line">	SEX VARCHAR ( 1 ) ,</span><br><span class="line">	PRIMARY KEY (SID)</span><br><span class="line">);</span><br><span class="line">CREATE TABLE C(</span><br><span class="line">	CID VARCHAR ( 20 ) ,</span><br><span class="line">	CNAME VARCHAR(20),</span><br><span class="line">	TEACHER VARCHAR(20),</span><br><span class="line">	PRIMARY KEY (CID)</span><br><span class="line">);</span><br><span class="line">CREATE TABLE SC(</span><br><span class="line">	SID VARCHAR(20),</span><br><span class="line">	CID VARCHAR(20),</span><br><span class="line">	GRADE INT,</span><br><span class="line">	PRIMARY KEY (SID,CID),</span><br><span class="line">	FOREIGN KEY (SID) REFERENCES S(SID) ON UPDATE CASCADE ON DELETE CASCADE,</span><br><span class="line">	FOREIGN KEY (CID) REFERENCES C(CID) ON UPDATE CASCADE ON DELETE CASCADE</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h5 id="3、完整性约束设置及其测试"><a href="#3、完整性约束设置及其测试" class="headerlink" title="3、完整性约束设置及其测试"></a>3、完整性约束设置及其测试</h5><ul>
<li><p>完整性约束设置</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE S ADD CHECK (sex in (&#x27;f&#x27;,&#x27;m&#x27;));</span><br><span class="line">ALTER TABLE S ADD CHECK (0 &lt;= age and age &lt;=200) ;</span><br></pre></td></tr></table></figure>

<ul>
<li>测试</li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO S (SID, SNAME, AGE, SEX)</span><br><span class="line">             VALUES (&#x27;S1&#x27;,&#x27;Wang feng&#x27;, 20, &#x27;f&#x27;);</span><br><span class="line">INSERT INTO S (SID, SNAME, AGE, SEX)</span><br><span class="line">             VALUES (&#x27;S2&#x27;,&#x27;Li feng&#x27;, 20, &#x27;t&#x27;);</span><br><span class="line">INSERT INTO S (SID, SNAME, AGE, SEX)</span><br><span class="line">             VALUES (&#x27;S2&#x27;,&#x27;Li feng&#x27;, -1, &#x27;m&#x27;);</span><br><span class="line">INSERT INTO S (SID, SNAME, AGE, SEX)</span><br><span class="line">             VALUES (&#x27;S2&#x27;,&#x27;Li feng&#x27;, 14, &#x27;m&#x27;);</span><br></pre></td></tr></table></figure>
<ul>
<li>运行结果</li>
</ul>
</li>
</ul>
<p><img src="/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/image-20200402212557918.png" alt="image-20200402212557918"></p>
<p><img src="/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/image-20200402212646716.png" alt="image-20200402212646716"></p>
<p><img src="/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/image-20200402212702535.png" alt="image-20200402212702535"></p>
<ul>
<li><p>触发器定义及测试</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER student_insert_check BEFORE INSERT</span><br><span class="line">ON s FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">  DECLARE msg varchar(100);</span><br><span class="line">	IF NEW.age &lt;= 0 OR NEW.age &gt;= 200 </span><br><span class="line">	THEN</span><br><span class="line">		SET msg = CONCAT(&#x27;您输入的年龄值：&#x27;,NEW.age,&#x27; 为无效的年龄，请输入0到200以内的有效数字。&#x27;);</span><br><span class="line">		SIGNAL SQLSTATE &#x27;HY000&#x27; SET MESSAGE_TEXT = msg;</span><br><span class="line">	END IF;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">INSERT INTO S (SID, SNAME, AGE, SEX)</span><br><span class="line">			 VALUES (&#x27;S3&#x27;,&#x27;Cy&#x27;, 201, &#x27;f&#x27;);</span><br></pre></td></tr></table></figure>

<ul>
<li>结果</li>
</ul>
</li>
</ul>
<p><img src="/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/image-20200402212531207.png" alt="image-20200402212531207"></p>
<ul>
<li><p>外键约束测试</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO S (SID, SNAME, AGE, SEX)</span><br><span class="line">			 VALUES (&#x27;S1&#x27;,&#x27;Wang feng&#x27;, 20, &#x27;f&#x27;);</span><br><span class="line">INSERT INTO S (SID, SNAME, AGE, SEX)</span><br><span class="line">			 VALUES (&#x27;S2&#x27;,&#x27;Li feng&#x27;, 20, &#x27;t&#x27;);</span><br><span class="line">INSERT INTO S (SID, SNAME, AGE, SEX)</span><br><span class="line">			 VALUES (&#x27;S2&#x27;,&#x27;Li feng&#x27;, -1, &#x27;m&#x27;);</span><br><span class="line">INSERT INTO S (SID, SNAME, AGE, SEX)</span><br><span class="line">			 VALUES (&#x27;S2&#x27;,&#x27;Li feng&#x27;, 14, &#x27;m&#x27;);</span><br><span class="line">INSERT INTO C (CID, CNAME, TEACHER)</span><br><span class="line">       VALUES (&#x27;C1&#x27;, &#x27;DB&#x27;, &#x27;Li&#x27;);</span><br><span class="line">INSERT INTO C (CID, CNAME, TEACHER)</span><br><span class="line">       VALUES (&#x27;C2&#x27;, &#x27;maths&#x27;, &#x27;Ma&#x27;);</span><br><span class="line">INSERT INTO SC (SID, CID , GRADE)</span><br><span class="line">       VALUES (&#x27;S1&#x27;,&#x27;C1&#x27;,70);</span><br><span class="line">INSERT INTO SC (SID, CID , GRADE)</span><br><span class="line">       VALUES (&#x27;S2&#x27;,&#x27;C1&#x27;,81);</span><br><span class="line">INSERT INTO SC (SID, CID , GRADE)</span><br><span class="line">       VALUES (&#x27;S1&#x27;,&#x27;C2&#x27;,65);</span><br><span class="line">SELECT * FROM SC;</span><br><span class="line">DELETE FROM S WHERE SID = &#x27;S2&#x27; ;</span><br><span class="line">SELECT * FROM SC;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>结果</p>
<p>  <img src="/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/image-20200402213304283.png" alt="image-20200402213304283"></p>
<p>  <img src="/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/image-20200402213312189.png" alt="image-20200402213312189"></p>
</li>
</ul>
</li>
</ul>
<h5 id="3、MySQL上的用户和权限的设置"><a href="#3、MySQL上的用户和权限的设置" class="headerlink" title="3、MySQL上的用户和权限的设置"></a>3、MySQL上的用户和权限的设置</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER &#x27;test1&#x27;@&#x27;localhost&#x27; IDENTIFIED by &#x27;123&#x27;;</span><br><span class="line">CREATE USER &#x27;test2&#x27;@&#x27;localhost&#x27; IDENTIFIED by &#x27;123&#x27;;</span><br><span class="line">GRANT INSERT,UPDATE ON school.C TO &#x27;test1&#x27;@&#x27;localhost&#x27; WITH GRANT OPTION;</span><br><span class="line"></span><br><span class="line">revoke update on school.C from &#x27;test1&#x27;@&#x27;localhost&#x27;;</span><br><span class="line">show grants for &#x27;test2&#x27;@&#x27;localhost&#x27;;</span><br><span class="line">Drop user &#x27;test2&#x27;@&#x27;localhost&#x27;;</span><br></pre></td></tr></table></figure>



<p><img src="/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/image-20200402214727360.png" alt="image-20200402214727360"></p>
<p><img src="/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/image-20200402215318454.png" alt="image-20200402215318454"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ydreamw.github.io/2020/04/02/DBS-Project3-SQL%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7/" data-id="cksni4d9w0006rgvl4qhw4wep" data-title="DBS-Project3-SQL数据完整性" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/database/" rel="tag">database</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-ADS-project1-斐波那契堆优化的最短路径算法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/03/29/ADS-project1-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2020-03-28T17:28:29.000Z" itemprop="datePublished">2020-03-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/20ss/">20ss</a>►<a class="article-category-link" href="/categories/20ss/ADS/">ADS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/03/29/ADS-project1-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/">ADS-project1-斐波那契堆优化的最短路径算法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>源代码地址： <a target="_blank" rel="noopener" href="https://github.com/YdreamW/20ss/tree/master/ads/project1_Fibheap%26ShortestPath">https://github.com/YdreamW/20ss/tree/master/ads/project1_Fibheap%26ShortestPath</a></p>
<h2 id="题目要求"><a href="#题目要求" class="headerlink" title="题目要求"></a>题目要求</h2><p>Shortest path problems are ones of the most fundamental combinatorial optimization problems with many applications, both direct and as subroutines in other combinatorial optimization algorithms.  Algorithms for these problems have been studied since 1950’s and still remain an active area of research.</p>
<p>In this project you are supposed to compute the shortest paths using Dijkstra’s algorithm.  The implementation shall be based on a min-priority queue, such as a Fibonacci heap.  The goal of the project is to find the best data structure for the Dijkstra’s algorithm.</p>
<p>Your tasks are:</p>
<ul>
<li>(1)    Implement the algorithm with at least two different heap structures, while Fibonacci heap must be one of them.</li>
<li>(2)    Use the USA road networks for evaluation.  The data sets can be downloaded from <a target="_blank" rel="noopener" href="http://www.dis.uniroma1.it/challenge9/download.shtml">http://www.dis.uniroma1.it/challenge9/download.shtml</a> which provides the benchmarks for the <strong>9th DIMACS Implementation Challenge</strong>.  (<strong>Note:</strong> you must <strong>only list the download links</strong> of these test data sets instead of uploading them with your reports.)</li>
<li>(3)    At least 1000 pairs of query are required in evaluating the run times of the algorithm with various of implementations.</li>
</ul>
<p>###Grading Policy:</p>
<p><strong>Programming:</strong> Implement Dijkstra’s algorithm with Fibonacci heap and other heaps (6 pts.).  Write a test of performance program (3 pts.).  <strong>All the codes must be sufficiently commented.</strong></p>
<p><strong>Testing:</strong> Provide the necessary inputs for testing and give the run time table (2 pts.).  Plot the run times vs. input sizes for illustration (2 pts.).  Write analysis and comments (3 pts.).</p>
<p><strong>Documentation:</strong> Chapter 1 (1 pt.), Chapter 2 (2 pts.), and finally a complete report (1 point for overall style of documentation).</p>
<h2 id="斐波那契堆-参考-斐波那契堆"><a href="#斐波那契堆-参考-斐波那契堆" class="headerlink" title="斐波那契堆: (参考:斐波那契堆)"></a>斐波那契堆: (参考:<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40061421/article/details/81571132">斐波那契堆</a>)</h2><p>斐波那契堆(Fibonacci heap)是堆中一种，它和二项堆一样，也是一种可合并堆；可用于实现合并优先队列。斐波那契堆比二项堆具有更好的平摊分析性能，它的合并操作的时间复杂度是O(1)。<br>与二项堆一样，它也是由一组堆最小有序树组成，并且是一种可合并堆。<br>与二项堆不同的是，斐波那契堆中的树不一定是二项树；而且二项堆中的树是有序排列的，但是斐波那契堆中的树都是有根而无序的。</p>
<p><img src="/2020/03/29/ADS-project1-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/111642221538159.jpg" alt="1"></p>
<ol>
<li>基本定义</li>
</ol>
<p>FibNode是斐波那契堆的节点类，它包含的信息较多。key是用于比较节点大小的，degree是记录节点的度，left和right分别是指向节点的左右兄弟，child是节点的第一个孩子，parent是节点的父节点，marked是记录该节点是否被删除第1个孩子(marked在删除节点时有用)。</p>
<p>FibHeap是斐波那契堆对应的类。min是保存当前堆的最小节点，keyNum用于记录堆中节点的总数，maxDegree用于记录堆中最大度，而cons在删除节点时来暂时保存堆数据的临时空间。</p>
<p>下面看看斐波那契堆的内存结构图。</p>
<p><img src="/2020/03/29/ADS-project1-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/111643182933476.jpg" alt="2"></p>
<p>从图中可以看出，斐波那契堆是由一组最小堆组成，这些最小堆的根节点组成了双向链表(后文称为”根链表”)；斐波那契堆中的最小节点就是”根链表中的最小节点”！</p>
<ol start="2">
<li>插入操作</li>
</ol>
<p>插入操作非常简单：插入一个节点到堆中，直接将该节点插入到”根链表的min节点”之前即可；若被插入节点比”min节点”小，则更新”min节点”为被插入节点。</p>
<p><img src="/2020/03/29/ADS-project1-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/3.jpg" alt="3"></p>
<p>上面是插入操作的示意图。</p>
<p>斐波那契堆的根链表是”双向链表”，这里将min节点看作双向联表的表头(后文也是如此)。在插入节点时，每次都是”将节点插入到min节点之前(即插入到双链表末尾)”。此外，对于根链表中最小堆都只有一个节点的情况，插入操作就很演化成双向链表的插入操作。</p>
<ol start="3">
<li>合并操作</li>
</ol>
<p>合并操作和插入操作的原理非常类似：将一个堆的根链表插入到另一个堆的根链表上即可。简单来说，就是将两个双链表拼接成一个双向链表。</p>
<p><img src="/2020/03/29/ADS-project1-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/4.jpg" alt="4"></p>
<ol start="4">
<li>取出最小节点</li>
</ol>
<p>抽取最小结点的操作是斐波那契堆中较复杂的操作。<br>(1）将要抽取最小结点的子树都直接串联在根表中；<br>(2）合并所有degree相等的树，直到没有相等的degree的树。</p>
<p><img src="/2020/03/29/ADS-project1-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/5.jpg" alt="5"></p>
<p>上面是取出最小节点的示意图。图中应该写的非常明白了，若有疑问，看代码。</p>
<ol start="5">
<li>减小节点值</li>
</ol>
<p>减少斐波那契堆中的节点的键值，这个操作的难点是：如果减少节点后破坏了”最小堆”性质，如何去维护呢？下面对一般性情况进行分析。<br>(1) 首先，将”被减小节点”从”它所在的最小堆”剥离出来；然后将”该节点”关联到”根链表”中。 倘若被减小的节点不是单独一个节点，而是包含子树的树根。则是将以”被减小节点”为根的子树从”最小堆”中剥离出来，然后将该树关联到根链表中。<br>(2) 接着，对”被减少节点”的原父节点进行”级联剪切”。所谓”级联剪切”，就是在被减小节点破坏了最小堆性质，并被切下来之后；再从”它的父节点”进行递归级联剪切操作。<br>      而级联操作的具体动作则是：若父节点(被减小节点的父节点)的marked标记为false，则将其设为true，然后退出。<br>                                                          否则，将父节点从最小堆中切下来(方式和”切被减小节点的方式”一样)；然后递归对祖父节点进行”级联剪切”。<br>      marked标记的作用就是用来标记”该节点的子节点是否有被删除过”，它的作用是来实现级联剪切。而级联剪切的真正目的是为了防止”最小堆”由二叉树演化成链表。<br>(3) 最后，别忘了对根链表的最小节点进行更新。</p>
<p><img src="/2020/03/29/ADS-project1-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/6.jpg" alt="6"></p>
<ol start="6">
<li>增加节点值</li>
</ol>
<p>增加节点值和减少节点值类似，这个操作的难点也是如何维护”最小堆”性质。思路如下：<br>(1) 将”被增加节点”的”左孩子和左孩子的所有兄弟”都链接到根链表中。<br>(2) 接下来，把”被增加节点”添加到根链表；但是别忘了对其进行级联剪切。</p>
<p><img src="/2020/03/29/ADS-project1-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/7.jpg" alt="7"></p>
<ol start="7">
<li>删除节点</li>
</ol>
<p>删除节点，本文采用了操作是：”取出最小节点”和”减小节点值”的组合。<br>(1) 先将被删除节点的键值减少。减少后的值要比”原最小节点的值”即可。<br>(2) 接着，取出最小节点即可。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ydreamw.github.io/2020/03/29/ADS-project1-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/" data-id="cksnhkjz80000f8vlgasd67dg" data-title="ADS-project1-斐波那契堆优化的最短路径算法" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/20ss/">20ss</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/20ss/ADS/">ADS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/20ss/DBS/">DBS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/20ss/Linux/">Linux</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/INA/">INA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5/">Web开发实践</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Web%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5/%E5%A4%9A%E8%AF%91/">多译</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5/%E8%AF%BE%E5%90%A6/">课否</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AA%E4%BA%BA%E8%AF%BE%E7%A8%8B%E4%BD%9C%E4%B8%9A/">个人课程作业</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AA%E4%BA%BA%E8%AF%BE%E7%A8%8B%E4%BD%9C%E4%B8%9A/19aw/">19aw</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AA%E4%BA%BA%E9%9A%8F%E7%AC%94/">个人随笔</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ant-Design/" rel="tag">Ant Design</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dva/" rel="tag">Dva</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Egg-js/" rel="tag">Egg.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hooks/" rel="tag">Hooks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redux/" rel="tag">Redux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TODO/" rel="tag">TODO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Umi/" rel="tag">Umi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/" rel="tag">Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebStorm/" rel="tag">WebStorm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/" rel="tag">database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/" rel="tag">shell</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Ant-Design/" style="font-size: 10px;">Ant Design</a> <a href="/tags/Dva/" style="font-size: 10px;">Dva</a> <a href="/tags/Egg-js/" style="font-size: 10px;">Egg.js</a> <a href="/tags/Hooks/" style="font-size: 10px;">Hooks</a> <a href="/tags/Linux/" style="font-size: 16.67px;">Linux</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/React/" style="font-size: 16.67px;">React</a> <a href="/tags/Redux/" style="font-size: 10px;">Redux</a> <a href="/tags/TODO/" style="font-size: 13.33px;">TODO</a> <a href="/tags/TypeScript/" style="font-size: 10px;">TypeScript</a> <a href="/tags/Umi/" style="font-size: 10px;">Umi</a> <a href="/tags/Web/" style="font-size: 16.67px;">Web</a> <a href="/tags/WebStorm/" style="font-size: 10px;">WebStorm</a> <a href="/tags/database/" style="font-size: 20px;">database</a> <a href="/tags/shell/" style="font-size: 13.33px;">shell</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/08/19/%E3%80%8A%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAnodejs%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/">《深入浅出nodejs》阅读笔记</a>
          </li>
        
          <li>
            <a href="/2021/08/17/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JS%E4%B8%8A%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/">你不知道的JS上阅读笔记</a>
          </li>
        
          <li>
            <a href="/2021/08/15/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/07/14/hello-hexo/">hello hexo</a>
          </li>
        
          <li>
            <a href="/2020/06/21/Linux-Lab3/">Linux-Lab3</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Ydream<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>